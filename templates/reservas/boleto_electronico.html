{% extends 'base.html' %}

{% block title %}Boleto Electrónico - {{ boleto.reserva.codigo_reserva }}{% endblock %}

{% block extra_head %}
<style media="print">
    body {
        margin: 0;
        padding: 0;
        background-color: white !important;
    }
    .navbar, .footer, .btn, .alert, .no-print {
        display: none !important;
    }
    .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
    }
    .ticket-card {
        border: 2px solid #0d6efd !important;
        box-shadow: none !important;
    }
    .ticket-header {
        background-color: #0d6efd !important;
        color: white !important;
    }
    .barcode-container {
        width: 100%;
        max-width: 300px;
        height: 80px;
        display: block;
        margin: 20px auto;
        background: repeating-linear-gradient(
            90deg,
            #000 0px,
            #000 2px,
            #fff 2px,
            #fff 4px
        );
        border: 1px solid #ddd;
        position: relative;
    }
    .barcode-text {
        position: absolute;
        bottom: -25px;
        left: 50%;
        transform: translateX(-50%);
        font-family: monospace;
        font-size: 12px;
        letter-spacing: 2px;
    }
</style>
{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4 no-print">
    <h2 class="text-primary"><i class="fas fa-ticket-alt"></i> Boleto Electrónico</h2>
    <button onclick="window.print()" class="btn btn-primary">
        <i class="fas fa-print"></i> Imprimir Boleto
    </button>
</div>

<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card ticket-card shadow-lg border-primary rounded-lg mt-3">
            <div class="card-header ticket-header text-center py-4">
                <h3 class="fw-light my-0"><i class="fas fa-plane-departure"></i> AeroSystem - Pase de Abordar</h3>
                <h4 class="mb-0 mt-2">Reserva: {{ boleto.reserva.codigo_reserva }}</h4>
            </div>
            <div class="card-body p-4">
                <div class="row mb-4">
                    <div class="col-md-6">
                        <h5 class="text-primary"><i class="fas fa-user"></i> Pasajero</h5>
                        <p class="mb-1"><strong>Nombre:</strong> {{ boleto.reserva.pasajero.nombre }} {{ boleto.reserva.pasajero.apellido }}</p>
                        <p class="mb-1"><strong>Documento:</strong> {{ boleto.reserva.pasajero.documento }}</p>
                    </div>
                    <div class="col-md-6">
                        <h5 class="text-info"><i class="fas fa-plane"></i> Vuelo</h5>
                        <p class="mb-1"><strong>Origen:</strong> {{ boleto.reserva.vuelo.origen }}</p>
                        <p class="mb-1"><strong>Destino:</strong> {{ boleto.reserva.vuelo.destino }}</p>
                        <p class="mb-1"><strong>Fecha Salida:</strong> {{ boleto.reserva.vuelo.fecha_salida|date:"d/m/Y H:i" }}</p>
                        <p class="mb-1"><strong>Avión:</strong> {{ boleto.reserva.vuelo.avion.modelo }}</p>
                    </div>
                </div>

                <hr class="my-4">

                <div class="row mb-4">
                    <div class="col-md-6">
                        <h5 class="text-success"><i class="fas fa-chair"></i> Detalles del Asiento</h5>
                        <p class="mb-1"><strong>Asiento:</strong> <span class="badge bg-success fs-5">{{ boleto.reserva.asiento.numero|default:"N/A" }}</span></p>
                        <p class="mb-1"><strong>Tipo:</strong> {{ boleto.reserva.asiento.get_tipo_display|default:"N/A" }}</p>
                        <p class="mb-1"><strong>Precio:</strong> ${{ boleto.reserva.precio }}</p>
                    </div>
                    <div class="col-md-6">
                        <h5 class="text-secondary"><i class="fas fa-info-circle"></i> Información del Boleto</h5>
                        <p class="mb-1"><strong>Código de Barra:</strong> {{ boleto.codigo_barra }}</p>
                        <p class="mb-1"><strong>Fecha de Emisión:</strong> {{ boleto.fecha_emision|date:"d/m/Y H:i" }}</p>
                        <p class="mb-1"><strong>Estado:</strong> 
                            <span class="badge bg-{% if boleto.estado == 'emitido' %}success{% elif boleto.estado == 'usado' %}primary{% else %}danger{% endif %}">
                                {{ boleto.get_estado_display }}
                            </span>
                        </p>
                    </div>
                </div>

                <div class="text-center mt-4">
                    <!-- Código de barras simulado con CSS -->
                    <div class="barcode-container">
                        <div class="barcode-text">{{ boleto.codigo_barra|slice:":8" }}...{{ boleto.codigo_barra|slice:"-8:" }}</div>
                    </div>
                    <p class="text-muted small mt-4">Presente este código de barras al abordar.</p>
                </div>
            </div>
            <div class="card-footer text-center text-muted small py-3">
                ¡Gracias por volar con AeroSystem! • Llegue al aeropuerto 2 horas antes del vuelo
            </div>
        </div>
    </div>
</div>

<div class="d-grid gap-2 d-md-flex justify-content-md-center mt-4 no-print">
    <a href="{% url 'detalle_reserva' boleto.reserva.codigo_reserva %}" class="btn btn-secondary">
        <i class="fas fa-arrow-left"></i> Volver a la Reserva
    </a>
</div>
{% endblock %}
